"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/auth/login/route";
exports.ids = ["app/api/auth/login/route"];
exports.modules = {

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "node:buffer":
/*!******************************!*\
  !*** external "node:buffer" ***!
  \******************************/
/***/ ((module) => {

module.exports = require("node:buffer");

/***/ }),

/***/ "node:crypto":
/*!******************************!*\
  !*** external "node:crypto" ***!
  \******************************/
/***/ ((module) => {

module.exports = require("node:crypto");

/***/ }),

/***/ "node:util":
/*!****************************!*\
  !*** external "node:util" ***!
  \****************************/
/***/ ((module) => {

module.exports = require("node:util");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fauth%2Flogin%2Froute&page=%2Fapi%2Fauth%2Flogin%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fauth%2Flogin%2Froute.ts&appDir=C%3A%5CUsers%5Cadmin%5CDesktop%5Cbianqian%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5Cadmin%5CDesktop%5Cbianqian&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fauth%2Flogin%2Froute&page=%2Fapi%2Fauth%2Flogin%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fauth%2Flogin%2Froute.ts&appDir=C%3A%5CUsers%5Cadmin%5CDesktop%5Cbianqian%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5Cadmin%5CDesktop%5Cbianqian&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var C_Users_admin_Desktop_bianqian_src_app_api_auth_login_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./src/app/api/auth/login/route.ts */ \"(rsc)/./src/app/api/auth/login/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/auth/login/route\",\n        pathname: \"/api/auth/login\",\n        filename: \"route\",\n        bundlePath: \"app/api/auth/login/route\"\n    },\n    resolvedPagePath: \"C:\\\\Users\\\\admin\\\\Desktop\\\\bianqian\\\\src\\\\app\\\\api\\\\auth\\\\login\\\\route.ts\",\n    nextConfigOutput,\n    userland: C_Users_admin_Desktop_bianqian_src_app_api_auth_login_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/auth/login/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZhdXRoJTJGbG9naW4lMkZyb3V0ZSZwYWdlPSUyRmFwaSUyRmF1dGglMkZsb2dpbiUyRnJvdXRlJmFwcFBhdGhzPSZwYWdlUGF0aD1wcml2YXRlLW5leHQtYXBwLWRpciUyRmFwaSUyRmF1dGglMkZsb2dpbiUyRnJvdXRlLnRzJmFwcERpcj1DJTNBJTVDVXNlcnMlNUNhZG1pbiU1Q0Rlc2t0b3AlNUNiaWFucWlhbiU1Q3NyYyU1Q2FwcCZwYWdlRXh0ZW5zaW9ucz10c3gmcGFnZUV4dGVuc2lvbnM9dHMmcGFnZUV4dGVuc2lvbnM9anN4JnBhZ2VFeHRlbnNpb25zPWpzJnJvb3REaXI9QyUzQSU1Q1VzZXJzJTVDYWRtaW4lNUNEZXNrdG9wJTVDYmlhbnFpYW4maXNEZXY9dHJ1ZSZ0c2NvbmZpZ1BhdGg9dHNjb25maWcuanNvbiZiYXNlUGF0aD0mYXNzZXRQcmVmaXg9Jm5leHRDb25maWdPdXRwdXQ9JnByZWZlcnJlZFJlZ2lvbj0mbWlkZGxld2FyZUNvbmZpZz1lMzAlM0QhIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7OztBQUFzRztBQUN2QztBQUNjO0FBQ3lCO0FBQ3RHO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixnSEFBbUI7QUFDM0M7QUFDQSxjQUFjLHlFQUFTO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxZQUFZO0FBQ1osQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBLFFBQVEsaUVBQWlFO0FBQ3pFO0FBQ0E7QUFDQSxXQUFXLDRFQUFXO0FBQ3RCO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDdUg7O0FBRXZIIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbWVtb3ZhdWx0Lz82NWVjIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEFwcFJvdXRlUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUtbW9kdWxlcy9hcHAtcm91dGUvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgcGF0Y2hGZXRjaCBhcyBfcGF0Y2hGZXRjaCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2xpYi9wYXRjaC1mZXRjaFwiO1xuaW1wb3J0ICogYXMgdXNlcmxhbmQgZnJvbSBcIkM6XFxcXFVzZXJzXFxcXGFkbWluXFxcXERlc2t0b3BcXFxcYmlhbnFpYW5cXFxcc3JjXFxcXGFwcFxcXFxhcGlcXFxcYXV0aFxcXFxsb2dpblxcXFxyb3V0ZS50c1wiO1xuLy8gV2UgaW5qZWN0IHRoZSBuZXh0Q29uZmlnT3V0cHV0IGhlcmUgc28gdGhhdCB3ZSBjYW4gdXNlIHRoZW0gaW4gdGhlIHJvdXRlXG4vLyBtb2R1bGUuXG5jb25zdCBuZXh0Q29uZmlnT3V0cHV0ID0gXCJcIlxuY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgQXBwUm91dGVSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuQVBQX1JPVVRFLFxuICAgICAgICBwYWdlOiBcIi9hcGkvYXV0aC9sb2dpbi9yb3V0ZVwiLFxuICAgICAgICBwYXRobmFtZTogXCIvYXBpL2F1dGgvbG9naW5cIixcbiAgICAgICAgZmlsZW5hbWU6IFwicm91dGVcIixcbiAgICAgICAgYnVuZGxlUGF0aDogXCJhcHAvYXBpL2F1dGgvbG9naW4vcm91dGVcIlxuICAgIH0sXG4gICAgcmVzb2x2ZWRQYWdlUGF0aDogXCJDOlxcXFxVc2Vyc1xcXFxhZG1pblxcXFxEZXNrdG9wXFxcXGJpYW5xaWFuXFxcXHNyY1xcXFxhcHBcXFxcYXBpXFxcXGF1dGhcXFxcbG9naW5cXFxccm91dGUudHNcIixcbiAgICBuZXh0Q29uZmlnT3V0cHV0LFxuICAgIHVzZXJsYW5kXG59KTtcbi8vIFB1bGwgb3V0IHRoZSBleHBvcnRzIHRoYXQgd2UgbmVlZCB0byBleHBvc2UgZnJvbSB0aGUgbW9kdWxlLiBUaGlzIHNob3VsZFxuLy8gYmUgZWxpbWluYXRlZCB3aGVuIHdlJ3ZlIG1vdmVkIHRoZSBvdGhlciByb3V0ZXMgdG8gdGhlIG5ldyBmb3JtYXQuIFRoZXNlXG4vLyBhcmUgdXNlZCB0byBob29rIGludG8gdGhlIHJvdXRlLlxuY29uc3QgeyByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcyB9ID0gcm91dGVNb2R1bGU7XG5jb25zdCBvcmlnaW5hbFBhdGhuYW1lID0gXCIvYXBpL2F1dGgvbG9naW4vcm91dGVcIjtcbmZ1bmN0aW9uIHBhdGNoRmV0Y2goKSB7XG4gICAgcmV0dXJuIF9wYXRjaEZldGNoKHtcbiAgICAgICAgc2VydmVySG9va3MsXG4gICAgICAgIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2VcbiAgICB9KTtcbn1cbmV4cG9ydCB7IHJvdXRlTW9kdWxlLCByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcywgb3JpZ2luYWxQYXRobmFtZSwgcGF0Y2hGZXRjaCwgIH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFwcC1yb3V0ZS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fauth%2Flogin%2Froute&page=%2Fapi%2Fauth%2Flogin%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fauth%2Flogin%2Froute.ts&appDir=C%3A%5CUsers%5Cadmin%5CDesktop%5Cbianqian%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5Cadmin%5CDesktop%5Cbianqian&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./src/app/api/auth/login/route.ts":
/*!*****************************************!*\
  !*** ./src/app/api/auth/login/route.ts ***!
  \*****************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var _server_auth__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/server/auth */ \"(rsc)/./src/server/auth.ts\");\n/**\r\n * 用户登录 API 路由（Local-First 模式）\r\n * POST /api/auth/login\r\n * \r\n * 注意：此版本仅用于生成 JWT Token\r\n * 用户验证在客户端完成\r\n */ \n\nasync function POST(request) {\n    try {\n        const body = await request.json();\n        const { email, password, userId } = body;\n        // 验证输入\n        if (!email || !password || !userId) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: false,\n                error: {\n                    code: \"INVALID_INPUT\",\n                    message: \"邮箱、密码和用户 ID 不能为空\"\n                }\n            }, {\n                status: 400\n            });\n        }\n        // 生成 JWT Token（使用客户端提供的 userId）\n        const token = await (0,_server_auth__WEBPACK_IMPORTED_MODULE_1__.generateToken)({\n            userId,\n            email\n        });\n        // 返回 Token\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: true,\n            data: {\n                token,\n                userId,\n                email,\n                message: \"登录成功（Local-First 模式：数据存储在本地 IndexedDB）\"\n            }\n        });\n    } catch (error) {\n        console.error(\"[API] Login error:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: false,\n            error: {\n                code: \"INTERNAL_ERROR\",\n                message: \"登录失败，请稍后重试\"\n            }\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvYXBwL2FwaS9hdXRoL2xvZ2luL3JvdXRlLnRzIiwibWFwcGluZ3MiOiI7Ozs7OztBQUFBOzs7Ozs7Q0FNQyxHQUV1RDtBQUNWO0FBRXZDLGVBQWVFLEtBQUtDLE9BQW9CO0lBQzdDLElBQUk7UUFDRixNQUFNQyxPQUFPLE1BQU1ELFFBQVFFLElBQUk7UUFDL0IsTUFBTSxFQUFFQyxLQUFLLEVBQUVDLFFBQVEsRUFBRUMsTUFBTSxFQUFFLEdBQUdKO1FBRXBDLE9BQU87UUFDUCxJQUFJLENBQUNFLFNBQVMsQ0FBQ0MsWUFBWSxDQUFDQyxRQUFRO1lBQ2xDLE9BQU9SLHFEQUFZQSxDQUFDSyxJQUFJLENBQ3RCO2dCQUFFSSxTQUFTO2dCQUFPQyxPQUFPO29CQUFFQyxNQUFNO29CQUFpQkMsU0FBUztnQkFBbUI7WUFBRSxHQUNoRjtnQkFBRUMsUUFBUTtZQUFJO1FBRWxCO1FBRUEsZ0NBQWdDO1FBQ2hDLE1BQU1DLFFBQVEsTUFBTWIsMkRBQWFBLENBQUM7WUFDaENPO1lBQ0FGO1FBQ0Y7UUFFQSxXQUFXO1FBQ1gsT0FBT04scURBQVlBLENBQUNLLElBQUksQ0FBQztZQUN2QkksU0FBUztZQUNUTSxNQUFNO2dCQUNKRDtnQkFDQU47Z0JBQ0FGO2dCQUNBTSxTQUFTO1lBQ1g7UUFDRjtJQUNGLEVBQUUsT0FBT0YsT0FBTztRQUNkTSxRQUFRTixLQUFLLENBQUMsc0JBQXNCQTtRQUNwQyxPQUFPVixxREFBWUEsQ0FBQ0ssSUFBSSxDQUN0QjtZQUFFSSxTQUFTO1lBQU9DLE9BQU87Z0JBQUVDLE1BQU07Z0JBQWtCQyxTQUFTO1lBQWE7UUFBRSxHQUMzRTtZQUFFQyxRQUFRO1FBQUk7SUFFbEI7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL21lbW92YXVsdC8uL3NyYy9hcHAvYXBpL2F1dGgvbG9naW4vcm91dGUudHM/ZDMxYSJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcclxuICog55So5oi355m75b2VIEFQSSDot6/nlLHvvIhMb2NhbC1GaXJzdCDmqKHlvI/vvIlcclxuICogUE9TVCAvYXBpL2F1dGgvbG9naW5cclxuICogXHJcbiAqIOazqOaEj++8muatpOeJiOacrOS7heeUqOS6jueUn+aIkCBKV1QgVG9rZW5cclxuICog55So5oi36aqM6K+B5Zyo5a6i5oi356uv5a6M5oiQXHJcbiAqL1xyXG5cclxuaW1wb3J0IHsgTmV4dFJlcXVlc3QsIE5leHRSZXNwb25zZSB9IGZyb20gJ25leHQvc2VydmVyJztcclxuaW1wb3J0IHsgZ2VuZXJhdGVUb2tlbiB9IGZyb20gJ0Avc2VydmVyL2F1dGgnO1xyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIFBPU1QocmVxdWVzdDogTmV4dFJlcXVlc3QpIHtcclxuICB0cnkge1xyXG4gICAgY29uc3QgYm9keSA9IGF3YWl0IHJlcXVlc3QuanNvbigpO1xyXG4gICAgY29uc3QgeyBlbWFpbCwgcGFzc3dvcmQsIHVzZXJJZCB9ID0gYm9keTtcclxuXHJcbiAgICAvLyDpqozor4HovpPlhaVcclxuICAgIGlmICghZW1haWwgfHwgIXBhc3N3b3JkIHx8ICF1c2VySWQpIHtcclxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxyXG4gICAgICAgIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiB7IGNvZGU6ICdJTlZBTElEX0lOUFVUJywgbWVzc2FnZTogJ+mCrueuseOAgeWvhueggeWSjOeUqOaItyBJRCDkuI3og73kuLrnqbonIH0gfSxcclxuICAgICAgICB7IHN0YXR1czogNDAwIH1cclxuICAgICAgKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyDnlJ/miJAgSldUIFRva2Vu77yI5L2/55So5a6i5oi356uv5o+Q5L6b55qEIHVzZXJJZO+8iVxyXG4gICAgY29uc3QgdG9rZW4gPSBhd2FpdCBnZW5lcmF0ZVRva2VuKHtcclxuICAgICAgdXNlcklkLFxyXG4gICAgICBlbWFpbCxcclxuICAgIH0pO1xyXG5cclxuICAgIC8vIOi/lOWbniBUb2tlblxyXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHtcclxuICAgICAgc3VjY2VzczogdHJ1ZSxcclxuICAgICAgZGF0YToge1xyXG4gICAgICAgIHRva2VuLFxyXG4gICAgICAgIHVzZXJJZCxcclxuICAgICAgICBlbWFpbCxcclxuICAgICAgICBtZXNzYWdlOiAn55m75b2V5oiQ5Yqf77yITG9jYWwtRmlyc3Qg5qih5byP77ya5pWw5o2u5a2Y5YKo5Zyo5pys5ZywIEluZGV4ZWREQu+8iScsXHJcbiAgICAgIH0sXHJcbiAgICB9KTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignW0FQSV0gTG9naW4gZXJyb3I6JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxyXG4gICAgICB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogeyBjb2RlOiAnSU5URVJOQUxfRVJST1InLCBtZXNzYWdlOiAn55m75b2V5aSx6LSl77yM6K+356iN5ZCO6YeN6K+VJyB9IH0sXHJcbiAgICAgIHsgc3RhdHVzOiA1MDAgfVxyXG4gICAgKTtcclxuICB9XHJcbn1cclxuIl0sIm5hbWVzIjpbIk5leHRSZXNwb25zZSIsImdlbmVyYXRlVG9rZW4iLCJQT1NUIiwicmVxdWVzdCIsImJvZHkiLCJqc29uIiwiZW1haWwiLCJwYXNzd29yZCIsInVzZXJJZCIsInN1Y2Nlc3MiLCJlcnJvciIsImNvZGUiLCJtZXNzYWdlIiwic3RhdHVzIiwidG9rZW4iLCJkYXRhIiwiY29uc29sZSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/app/api/auth/login/route.ts\n");

/***/ }),

/***/ "(rsc)/./src/server/auth.ts":
/*!****************************!*\
  !*** ./src/server/auth.ts ***!
  \****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   authenticateRequest: () => (/* binding */ authenticateRequest),\n/* harmony export */   extractTokenFromHeader: () => (/* binding */ extractTokenFromHeader),\n/* harmony export */   generateToken: () => (/* binding */ generateToken),\n/* harmony export */   isTokenExpiringSoon: () => (/* binding */ isTokenExpiringSoon),\n/* harmony export */   verifyToken: () => (/* binding */ verifyToken)\n/* harmony export */ });\n/* harmony import */ var jose__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! jose */ \"(rsc)/./node_modules/jose/dist/node/esm/jwt/sign.js\");\n/* harmony import */ var jose__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! jose */ \"(rsc)/./node_modules/jose/dist/node/esm/jwt/verify.js\");\n/**\r\n * MemoVault 认证服务\r\n * 基于 JWT (JSON Web Token)\r\n */ \n// ============================================================================\n// 配置常量\n// ============================================================================\nconst JWT_CONFIG = {\n    algorithm: \"HS256\",\n    expiresIn: \"7d\",\n    issuer: \"memovault\",\n    audience: \"memovault-users\"\n};\n// ============================================================================\n// 密钥管理\n// ============================================================================\n/**\r\n * 获取 JWT 签名密钥\r\n */ function getSigningKey() {\n    const secret = process.env.JWT_SECRET || \"your-super-secret-key-change-in-production\";\n    return new TextEncoder().encode(secret);\n}\n// ============================================================================\n// Token 生成\n// ============================================================================\n/**\r\n * 生成 JWT Token\r\n * \r\n * @param payload - Token 载荷\r\n * @returns JWT Token 字符串\r\n */ async function generateToken(payload) {\n    try {\n        const secret = getSigningKey();\n        const token = await new jose__WEBPACK_IMPORTED_MODULE_0__.SignJWT({\n            userId: payload.userId,\n            email: payload.email\n        }).setProtectedHeader({\n            alg: JWT_CONFIG.algorithm\n        }).setIssuedAt().setExpirationTime(JWT_CONFIG.expiresIn).setIssuer(JWT_CONFIG.issuer).setAudience(JWT_CONFIG.audience).sign(secret);\n        return token;\n    } catch (error) {\n        console.error(\"[Auth] Error generating token:\", error);\n        throw new Error(\"Failed to generate token\");\n    }\n}\n// ============================================================================\n// Token 验证\n// ============================================================================\n/**\r\n * 验证 JWT Token\r\n * \r\n * @param token - JWT Token 字符串\r\n * @returns 解码后的载荷\r\n */ async function verifyToken(token) {\n    try {\n        const secret = getSigningKey();\n        const { payload } = await (0,jose__WEBPACK_IMPORTED_MODULE_1__.jwtVerify)(token, secret, {\n            issuer: JWT_CONFIG.issuer,\n            audience: JWT_CONFIG.audience\n        });\n        return {\n            userId: payload.userId,\n            email: payload.email,\n            iat: payload.iat,\n            exp: payload.exp\n        };\n    } catch (error) {\n        console.error(\"[Auth] Token verification failed:\", error);\n        throw new Error(\"Invalid or expired token\");\n    }\n}\n/**\r\n * 检查 Token 是否即将过期\r\n * \r\n * @param token - JWT Token 字符串\r\n * @param thresholdSeconds - 提前多少秒视为即将过期（默认 1 天）\r\n * @returns 是否即将过期\r\n */ async function isTokenExpiringSoon(token, thresholdSeconds = 86400) {\n    try {\n        const decoded = await verifyToken(token);\n        const now = Math.floor(Date.now() / 1000);\n        const timeUntilExpiry = decoded.exp - now;\n        return timeUntilExpiry <= thresholdSeconds;\n    } catch (error) {\n        console.error(\"[Auth] Error checking token expiry:\", error);\n        return true; // 如果验证失败，视为已过期\n    }\n}\n// ============================================================================\n// 中间件辅助函数\n// ============================================================================\n/**\r\n * 从请求头中提取 Token\r\n * \r\n * @param authHeader - Authorization 头\r\n * @returns Token 字符串或 null\r\n */ function extractTokenFromHeader(authHeader) {\n    if (!authHeader) return null;\n    const parts = authHeader.split(\" \");\n    if (parts.length !== 2 || parts[0] !== \"Bearer\") {\n        return null;\n    }\n    return parts[1];\n}\n/**\r\n * 验证请求中的 Token\r\n * \r\n * @param authHeader - Authorization 头\r\n * @returns 解码后的载荷或 null\r\n */ async function authenticateRequest(authHeader) {\n    try {\n        const token = extractTokenFromHeader(authHeader);\n        if (!token) {\n            return null;\n        }\n        const decoded = await verifyToken(token);\n        return {\n            userId: decoded.userId,\n            email: decoded.email\n        };\n    } catch (error) {\n        console.error(\"[Auth] Request authentication failed:\", error);\n        return null;\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QU16QixRQUFRd0IsdUJBQXVCQztRQUNyQyxJQUFJLENBQUN6QixPQUFPO1lBQ1YsT0FBTztRQUNUO1FBRUEsTUFBTWtCLFVBQVUsTUFBTUwsWUFBWWI7UUFDbEMsT0FBTztZQUNMQyxRQUFRaUIsUUFBUWpCLE1BQU07WUFDdEJDLE9BQU9nQixRQUFRaEIsS0FBSztRQUN0QjtJQUNGLEVBQUUsT0FBT1EsT0FBTztRQUNkQyxRQUFRRCxLQUFLLENBQUMseUNBQXlDQTtRQUN2RCxPQUFPO0lBQ1Q7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL21lbW92YXVsdC8uL3NyYy9zZXJ2ZXIvYXV0aC50cz8yMmJiIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiBNZW1vVmF1bHQg6K6k6K+B5pyN5YqhXHJcbiAqIOWfuuS6jiBKV1QgKEpTT04gV2ViIFRva2VuKVxyXG4gKi9cclxuXHJcbmltcG9ydCB7IFNpZ25KV1QsIGp3dFZlcmlmeSB9IGZyb20gJ2pvc2UnO1xyXG5cclxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4vLyDphY3nva7luLjph49cclxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuY29uc3QgSldUX0NPTkZJRyA9IHtcclxuICBhbGdvcml0aG06ICdIUzI1NicgYXMgY29uc3QsXHJcbiAgZXhwaXJlc0luOiAnN2QnLCAvLyBUb2tlbiDmnInmlYjmnJ8gNyDlpKlcclxuICBpc3N1ZXI6ICdtZW1vdmF1bHQnLFxyXG4gIGF1ZGllbmNlOiAnbWVtb3ZhdWx0LXVzZXJzJyxcclxufTtcclxuXHJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8g5a+G6ZKl566h55CGXHJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuXHJcbi8qKlxyXG4gKiDojrflj5YgSldUIOetvuWQjeWvhumSpVxyXG4gKi9cclxuZnVuY3Rpb24gZ2V0U2lnbmluZ0tleSgpOiBVaW50OEFycmF5IHtcclxuICBjb25zdCBzZWNyZXQgPSBwcm9jZXNzLmVudi5KV1RfU0VDUkVUIHx8ICd5b3VyLXN1cGVyLXNlY3JldC1rZXktY2hhbmdlLWluLXByb2R1Y3Rpb24nO1xyXG4gIHJldHVybiBuZXcgVGV4dEVuY29kZXIoKS5lbmNvZGUoc2VjcmV0KTtcclxufVxyXG5cclxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4vLyBUb2tlbiDnlJ/miJBcclxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuLyoqXHJcbiAqIOeUn+aIkCBKV1QgVG9rZW5cclxuICogXHJcbiAqIEBwYXJhbSBwYXlsb2FkIC0gVG9rZW4g6L296I23XHJcbiAqIEByZXR1cm5zIEpXVCBUb2tlbiDlrZfnrKbkuLJcclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZW5lcmF0ZVRva2VuKHBheWxvYWQ6IHtcclxuICB1c2VySWQ6IHN0cmluZztcclxuICBlbWFpbDogc3RyaW5nO1xyXG59KTogUHJvbWlzZTxzdHJpbmc+IHtcclxuICB0cnkge1xyXG4gICAgY29uc3Qgc2VjcmV0ID0gZ2V0U2lnbmluZ0tleSgpO1xyXG4gICAgXHJcbiAgICBjb25zdCB0b2tlbiA9IGF3YWl0IG5ldyBTaWduSldUKHtcclxuICAgICAgdXNlcklkOiBwYXlsb2FkLnVzZXJJZCxcclxuICAgICAgZW1haWw6IHBheWxvYWQuZW1haWwsXHJcbiAgICB9KVxyXG4gICAgICAuc2V0UHJvdGVjdGVkSGVhZGVyKHsgYWxnOiBKV1RfQ09ORklHLmFsZ29yaXRobSB9KVxyXG4gICAgICAuc2V0SXNzdWVkQXQoKVxyXG4gICAgICAuc2V0RXhwaXJhdGlvblRpbWUoSldUX0NPTkZJRy5leHBpcmVzSW4pXHJcbiAgICAgIC5zZXRJc3N1ZXIoSldUX0NPTkZJRy5pc3N1ZXIpXHJcbiAgICAgIC5zZXRBdWRpZW5jZShKV1RfQ09ORklHLmF1ZGllbmNlKVxyXG4gICAgICAuc2lnbihzZWNyZXQpO1xyXG5cclxuICAgIHJldHVybiB0b2tlbjtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignW0F1dGhdIEVycm9yIGdlbmVyYXRpbmcgdG9rZW46JywgZXJyb3IpO1xyXG4gICAgdGhyb3cgbmV3IEVycm9yKCdGYWlsZWQgdG8gZ2VuZXJhdGUgdG9rZW4nKTtcclxuICB9XHJcbn1cclxuXHJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8gVG9rZW4g6aqM6K+BXHJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuXHJcbi8qKlxyXG4gKiDpqozor4EgSldUIFRva2VuXHJcbiAqIFxyXG4gKiBAcGFyYW0gdG9rZW4gLSBKV1QgVG9rZW4g5a2X56ym5LiyXHJcbiAqIEByZXR1cm5zIOino+eggeWQjueahOi9veiNt1xyXG4gKi9cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHZlcmlmeVRva2VuKHRva2VuOiBzdHJpbmcpOiBQcm9taXNlPHtcclxuICB1c2VySWQ6IHN0cmluZztcclxuICBlbWFpbDogc3RyaW5nO1xyXG4gIGlhdDogbnVtYmVyO1xyXG4gIGV4cDogbnVtYmVyO1xyXG59PiB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IHNlY3JldCA9IGdldFNpZ25pbmdLZXkoKTtcclxuICAgIFxyXG4gICAgY29uc3QgeyBwYXlsb2FkIH0gPSBhd2FpdCBqd3RWZXJpZnkodG9rZW4sIHNlY3JldCwge1xyXG4gICAgICBpc3N1ZXI6IEpXVF9DT05GSUcuaXNzdWVyLFxyXG4gICAgICBhdWRpZW5jZTogSldUX0NPTkZJRy5hdWRpZW5jZSxcclxuICAgIH0pO1xyXG5cclxuICAgIHJldHVybiB7XHJcbiAgICAgIHVzZXJJZDogcGF5bG9hZC51c2VySWQgYXMgc3RyaW5nLFxyXG4gICAgICBlbWFpbDogcGF5bG9hZC5lbWFpbCBhcyBzdHJpbmcsXHJcbiAgICAgIGlhdDogcGF5bG9hZC5pYXQgYXMgbnVtYmVyLFxyXG4gICAgICBleHA6IHBheWxvYWQuZXhwIGFzIG51bWJlcixcclxuICAgIH07XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ1tBdXRoXSBUb2tlbiB2ZXJpZmljYXRpb24gZmFpbGVkOicsIGVycm9yKTtcclxuICAgIHRocm93IG5ldyBFcnJvcignSW52YWxpZCBvciBleHBpcmVkIHRva2VuJyk7XHJcbiAgfVxyXG59XHJcblxyXG4vKipcclxuICog5qOA5p+lIFRva2VuIOaYr+WQpuWNs+Wwhui/h+acn1xyXG4gKiBcclxuICogQHBhcmFtIHRva2VuIC0gSldUIFRva2VuIOWtl+espuS4slxyXG4gKiBAcGFyYW0gdGhyZXNob2xkU2Vjb25kcyAtIOaPkOWJjeWkmuWwkeenkuinhuS4uuWNs+Wwhui/h+acn++8iOm7mOiupCAxIOWkqe+8iVxyXG4gKiBAcmV0dXJucyDmmK/lkKbljbPlsIbov4fmnJ9cclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBpc1Rva2VuRXhwaXJpbmdTb29uKFxyXG4gIHRva2VuOiBzdHJpbmcsXHJcbiAgdGhyZXNob2xkU2Vjb25kczogbnVtYmVyID0gODY0MDBcclxuKTogUHJvbWlzZTxib29sZWFuPiB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IGRlY29kZWQgPSBhd2FpdCB2ZXJpZnlUb2tlbih0b2tlbik7XHJcbiAgICBjb25zdCBub3cgPSBNYXRoLmZsb29yKERhdGUubm93KCkgLyAxMDAwKTtcclxuICAgIGNvbnN0IHRpbWVVbnRpbEV4cGlyeSA9IGRlY29kZWQuZXhwIC0gbm93O1xyXG4gICAgXHJcbiAgICByZXR1cm4gdGltZVVudGlsRXhwaXJ5IDw9IHRocmVzaG9sZFNlY29uZHM7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ1tBdXRoXSBFcnJvciBjaGVja2luZyB0b2tlbiBleHBpcnk6JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIHRydWU7IC8vIOWmguaenOmqjOivgeWksei0pe+8jOinhuS4uuW3sui/h+acn1xyXG4gIH1cclxufVxyXG5cclxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4vLyDkuK3pl7Tku7bovoXliqnlh73mlbBcclxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuLyoqXHJcbiAqIOS7juivt+axguWktOS4reaPkOWPliBUb2tlblxyXG4gKiBcclxuICogQHBhcmFtIGF1dGhIZWFkZXIgLSBBdXRob3JpemF0aW9uIOWktFxyXG4gKiBAcmV0dXJucyBUb2tlbiDlrZfnrKbkuLLmiJYgbnVsbFxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGV4dHJhY3RUb2tlbkZyb21IZWFkZXIoYXV0aEhlYWRlcjogc3RyaW5nIHwgbnVsbCk6IHN0cmluZyB8IG51bGwge1xyXG4gIGlmICghYXV0aEhlYWRlcikgcmV0dXJuIG51bGw7XHJcbiAgXHJcbiAgY29uc3QgcGFydHMgPSBhdXRoSGVhZGVyLnNwbGl0KCcgJyk7XHJcbiAgaWYgKHBhcnRzLmxlbmd0aCAhPT0gMiB8fCBwYXJ0c1swXSAhPT0gJ0JlYXJlcicpIHtcclxuICAgIHJldHVybiBudWxsO1xyXG4gIH1cclxuICBcclxuICByZXR1cm4gcGFydHNbMV07XHJcbn1cclxuXHJcbi8qKlxyXG4gKiDpqozor4Hor7fmsYLkuK3nmoQgVG9rZW5cclxuICogXHJcbiAqIEBwYXJhbSBhdXRoSGVhZGVyIC0gQXV0aG9yaXphdGlvbiDlpLRcclxuICogQHJldHVybnMg6Kej56CB5ZCO55qE6L296I235oiWIG51bGxcclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBhdXRoZW50aWNhdGVSZXF1ZXN0KFxyXG4gIGF1dGhIZWFkZXI6IHN0cmluZyB8IG51bGxcclxuKTogUHJvbWlzZTx7IHVzZXJJZDogc3RyaW5nOyBlbWFpbDogc3RyaW5nIH0gfCBudWxsPiB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IHRva2VuID0gZXh0cmFjdFRva2VuRnJvbUhlYWRlcihhdXRoSGVhZGVyKTtcclxuICAgIGlmICghdG9rZW4pIHtcclxuICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgZGVjb2RlZCA9IGF3YWl0IHZlcmlmeVRva2VuKHRva2VuKTtcclxuICAgIHJldHVybiB7XHJcbiAgICAgIHVzZXJJZDogZGVjb2RlZC51c2VySWQsXHJcbiAgICAgIGVtYWlsOiBkZWNvZGVkLmVtYWlsLFxyXG4gICAgfTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignW0F1dGhdIFJlcXVlc3QgYXV0aGVudGljYXRpb24gZmFpbGVkOicsIGVycm9yKTtcclxuICAgIHJldHVybiBudWxsO1xyXG4gIH1cclxufVxyXG4iXSwibmFtZXMiOlsiU2lnbkpXVCIsImp3dFZlcmlmeSIsIkpXVF9DT05GSUciLCJhbGdvcml0aG0iLCJleHBpcmVzSW4iLCJpc3N1ZXIiLCJhdWRpZW5jZSIsImdldFNpZ25pbmdLZXkiLCJzZWNyZXQiLCJwcm9jZXNzIiwiZW52IiwiSldUX1NFQ1JFVCIsIlRleHRFbmNvZGVyIiwiZW5jb2RlIiwiZ2VuZXJhdGVUb2tlbiIsInBheWxvYWQiLCJ0b2tlbiIsInVzZXJJZCIsImVtYWlsIiwic2V0UHJvdGVjdGVkSGVhZGVyIiwiYWxnIiwic2V0SXNzdWVkQXQiLCJzZXRFeHBpcmF0aW9uVGltZSIsInNldElzc3VlciIsInNldEF1ZGllbmNlIiwic2lnbiIsImVycm9yIiwiY29uc29sZSIsIkVycm9yIiwidmVyaWZ5VG9rZW4iLCJpYXQiLCJleHAiLCJpc1Rva2VuRXhwaXJpbmdTb29uIiwidGhyZXNob2xkU2Vjb25kcyIsImRlY29kZWQiLCJub3ciLCJNYXRoIiwiZmxvb3IiLCJEYXRlIiwidGltZVVudGlsRXhwaXJ5IiwiZXh0cmFjdFRva2VuRnJvbUhlYWRlciIsImF1dGhIZWFkZXIiLCJwYXJ0cyIsInNwbGl0IiwibGVuZ3RoIiwiYXV0aGVudGljYXRlUmVxdWVzdCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/server/auth.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/jose"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fauth%2Flogin%2Froute&page=%2Fapi%2Fauth%2Flogin%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fauth%2Flogin%2Froute.ts&appDir=C%3A%5CUsers%5Cadmin%5CDesktop%5Cbianqian%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5Cadmin%5CDesktop%5Cbianqian&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();