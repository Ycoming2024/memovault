"use strict";(()=>{var e={};e.id=873,e.ids=[873],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},2254:e=>{e.exports=require("node:buffer")},6005:e=>{e.exports=require("node:crypto")},7261:e=>{e.exports=require("node:util")},4154:(e,r,t)=>{t.r(r),t.d(r,{originalPathname:()=>m,patchFetch:()=>h,requestAsyncStorage:()=>d,routeModule:()=>p,serverHooks:()=>g,staticGenerationAsyncStorage:()=>l});var s={};t.r(s),t.d(s,{POST:()=>c});var o=t(9303),n=t(8716),a=t(670),i=t(7070),u=t(7115);async function c(e){try{let{email:r,password:t,userId:s}=await e.json();if(!r||!t||!s)return i.NextResponse.json({success:!1,error:{code:"INVALID_INPUT",message:"邮箱、密码和用户 ID 不能为空"}},{status:400});let o=await (0,u.RA)({userId:s,email:r});return i.NextResponse.json({success:!0,data:{token:o,userId:s,email:r,message:"登录成功（Local-First 模式：数据存储在本地 IndexedDB）"}})}catch(e){return console.error("[API] Login error:",e),i.NextResponse.json({success:!1,error:{code:"INTERNAL_ERROR",message:"登录失败，请稍后重试"}},{status:500})}}let p=new o.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/auth/login/route",pathname:"/api/auth/login",filename:"route",bundlePath:"app/api/auth/login/route"},resolvedPagePath:"C:\\Users\\admin\\Desktop\\bianqian\\src\\app\\api\\auth\\login\\route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:d,staticGenerationAsyncStorage:l,serverHooks:g}=p,m="/api/auth/login/route";function h(){return(0,a.patchFetch)({serverHooks:g,staticGenerationAsyncStorage:l})}},7115:(e,r,t)=>{t.d(r,{RA:()=>n});var s=t(7094);let o={algorithm:"HS256",expiresIn:"7d",issuer:"memovault",audience:"memovault-users"};async function n(e){try{let r=function(){let e=process.env.JWT_SECRET||"your-super-secret-key-change-in-production";return new TextEncoder().encode(e)}();return await new s.N({userId:e.userId,email:e.email}).setProtectedHeader({alg:o.algorithm}).setIssuedAt().setExpirationTime(o.expiresIn).setIssuer(o.issuer).setAudience(o.audience).sign(r)}catch(e){throw console.error("[Auth] Error generating token:",e),Error("Failed to generate token")}}}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[276,972,94],()=>t(4154));module.exports=s})();