(()=>{var e={};e.id=931,e.ids=[931],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},4406:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>l.a,__next_app__:()=>m,originalPathname:()=>u,pages:()=>d,routeModule:()=>h,tree:()=>c}),s(5480),s(2029),s(5866);var r=s(3191),a=s(8716),i=s(7922),l=s.n(i),n=s(5231),o={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>n[e]);s.d(t,o);let c=["",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,5480)),"C:\\Users\\admin\\Desktop\\bianqian\\src\\app\\page.tsx"]}]},{layout:[()=>Promise.resolve().then(s.bind(s,2029)),"C:\\Users\\admin\\Desktop\\bianqian\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,5866,23)),"next/dist/client/components/not-found-error"]}],d=["C:\\Users\\admin\\Desktop\\bianqian\\src\\app\\page.tsx"],u="/page",m={require:s,loadChunk:()=>Promise.resolve()},h=new r.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/page",pathname:"/",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},9608:(e,t,s)=>{Promise.resolve().then(s.t.bind(s,2994,23)),Promise.resolve().then(s.t.bind(s,6114,23)),Promise.resolve().then(s.t.bind(s,9727,23)),Promise.resolve().then(s.t.bind(s,9671,23)),Promise.resolve().then(s.t.bind(s,1868,23)),Promise.resolve().then(s.t.bind(s,4759,23))},9301:()=>{},1739:(e,t,s)=>{Promise.resolve().then(s.bind(s,7757))},7757:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>v});var r=s(326),a=s(7577),i=s(5047),l=s(6283),n=s(2881);let o=(0,n.Z)("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]),c=(0,n.Z)("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]),d=(0,n.Z)("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]),u={iterations:6e5,hash:"SHA-256"};async function m(e,t){try{let s=new TextEncoder().encode(e),r=await crypto.subtle.importKey("raw",s,"PBKDF2",!1,["deriveBits"]),a=await crypto.subtle.deriveBits({name:"PBKDF2",salt:t.buffer,iterations:u.iterations,hash:u.hash},r,256);return function(e){return Array.from(e).map(e=>e.toString(16).padStart(2,"0")).join("")}(new Uint8Array(a))}catch(e){throw console.error("[Crypto] Error deriving auth hash:",e),Error("Failed to derive auth hash")}}class h{setMasterKey(e){this.masterKey=e}getMasterKey(){return this.masterKey}setPrivateKey(e){this.privateKey=e}getPrivateKey(){return this.privateKey}clear(){this.masterKey=null,this.privateKey=null}isInitialized(){return null!==this.masterKey}constructor(){this.masterKey=null,this.privateKey=null}}new h;var x=s(3864);class p extends x.ZP{constructor(){super("MemoVaultUsers"),this.version(1).stores({users:"email, userId, createdAt"})}}let b=new p,g={exists:async e=>!!await b.users.where("email").equals(e).first(),async create(e,t,s){let r=crypto.randomUUID(),a={email:e,authHash:t,salt:Array.from(s),userId:r,createdAt:new Date},i=await b.users.add(a);return{...a,id:i}},get:async e=>await b.users.where("email").equals(e).first(),async verifyPassword(e,t){let s=await this.get(e);return!!s&&s.authHash===t},async delete(e){await b.users.where("email").equals(e).delete()},getAll:async()=>await b.users.toArray()};async function y(e,t){try{if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e))return{success:!1,error:{code:"INVALID_EMAIL",message:"邮箱格式不正确"}};if(t.length<8)return{success:!1,error:{code:"WEAK_PASSWORD",message:"密码至少需要 8 个字符"}};if(await g.exists(e))return{success:!1,error:{code:"EMAIL_EXISTS",message:"该邮箱已被注册"}};let s=crypto.getRandomValues(new Uint8Array(32)),r=await m(t,s),a=await g.create(e,r,s),i=await fetch("/api/auth/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t,userId:a.userId})}),l=await i.json();if(!l.success)return{success:!1,error:l.error};return{success:!0,data:{token:l.data.token,userId:a.userId,email:a.email,salt:a.salt}}}catch(e){return console.error("[AuthService] Register error:",e),{success:!1,error:{code:"INTERNAL_ERROR",message:"注册失败，请稍后重试"}}}}async function f(e,t){try{let s=await g.get(e);if(!s)return{success:!1,error:{code:"USER_NOT_FOUND",message:"用户不存在，请先注册"}};let r=new Uint8Array(s.salt),a=await m(t,r);if(s.authHash!==a)return{success:!1,error:{code:"INVALID_PASSWORD",message:"密码错误"}};let i=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t,userId:s.userId})}),l=await i.json();if(!l.success)return{success:!1,error:l.error};return{success:!0,data:{token:l.data.token,userId:s.userId,email:s.email,salt:s.salt}}}catch(e){return console.error("[AuthService] Login error:",e),{success:!1,error:{code:"INTERNAL_ERROR",message:"登录失败，请稍后重试"}}}}function v(){let e=(0,i.useRouter)(),[t,s]=(0,a.useState)(""),[n,u]=(0,a.useState)(""),[m,h]=(0,a.useState)(!1),[x,p]=(0,a.useState)(""),[b,g]=(0,a.useState)(!1),v=async s=>{s.preventDefault(),h(!0),p("");try{let s=b?await y(t,n):await f(t,n);s.success&&s.data?(localStorage.setItem("token",s.data.token),localStorage.setItem("userId",s.data.userId),localStorage.setItem("email",s.data.email),localStorage.setItem("salt",JSON.stringify(s.data.salt)),e.push("/app")):p(s.error?.message||"操作失败")}catch(e){console.error("Auth error:",e),p("网络错误，请稍后重试")}finally{h(!1)}};return r.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-slate-100 flex items-center justify-center p-4",children:(0,r.jsxs)("div",{className:"max-w-4xl w-full",children:[(0,r.jsxs)("div",{className:"text-center mb-12",children:[r.jsx("div",{className:"flex items-center justify-center mb-4",children:r.jsx(l.Z,{className:"w-16 h-16 text-blue-600"})}),r.jsx("h1",{className:"text-4xl font-bold text-slate-900 mb-2",children:"MemoVault"}),r.jsx("p",{className:"text-lg text-slate-600",children:"隐私优先的个人知识库"})]}),(0,r.jsxs)("div",{className:"grid md:grid-cols-3 gap-6 mb-12",children:[r.jsx(w,{icon:r.jsx(o,{className:"w-8 h-8"}),title:"端到端加密",description:"所有数据在本地加密，服务器零知悉"}),r.jsx(w,{icon:r.jsx(c,{className:"w-8 h-8"}),title:"本地优先",description:"数据存储在本地，离线也能使用"}),r.jsx(w,{icon:r.jsx(d,{className:"w-8 h-8"}),title:"实时同步",description:"使用 CRDT 技术，多端无缝同步"})]}),r.jsx("div",{className:"max-w-md mx-auto",children:(0,r.jsxs)("div",{className:"bg-white rounded-2xl shadow-lg p-8",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[r.jsx("h2",{className:"text-2xl font-bold text-slate-900 text-center",children:b?"创建账号":"欢迎回来"}),r.jsx("button",{type:"button",onClick:()=>{g(!b),p("")},className:"text-sm text-blue-600 hover:text-blue-700",children:b?"已有账号？登录":"没有账号？注册"})]}),x&&r.jsx("div",{className:"bg-red-50 border border-red-200 text-red-600 px-4 py-3 rounded-lg mb-4",children:x}),(0,r.jsxs)("form",{onSubmit:v,className:"space-y-4",children:[(0,r.jsxs)("div",{children:[r.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-slate-700 mb-2",children:"邮箱"}),r.jsx("input",{id:"email",type:"email",value:t,onChange:e=>s(e.target.value),required:!0,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none transition-all",placeholder:"your@email.com"})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-slate-700 mb-2",children:"密码"}),r.jsx("input",{id:"password",type:"password",value:n,onChange:e=>u(e.target.value),required:!0,minLength:8,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none transition-all",placeholder:"••••••••"}),r.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"密码至少需要 8 个字符"})]}),r.jsx("button",{type:"submit",disabled:m,className:"w-full bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 text-white font-semibold py-3 px-4 rounded-lg transition-colors",children:m?b?"注册中...":"登录中...":b?"注册":"登录"})]}),r.jsx("div",{className:"mt-6 text-center",children:r.jsx("a",{href:"#",className:"text-sm text-blue-600 hover:text-blue-700",children:"忘记密码？"})}),r.jsx("div",{className:"mt-6 pt-6 border-t border-slate-200 text-center",children:(0,r.jsxs)("p",{className:"text-sm text-slate-600",children:["还没有账号？"," ",r.jsx("a",{href:"#",className:"text-blue-600 hover:text-blue-700 font-medium",children:"注册"})]})})]})}),(0,r.jsxs)("div",{className:"mt-12 text-center text-sm text-slate-500",children:[r.jsx("p",{children:"\xa9 2024 MemoVault. All rights reserved."}),(0,r.jsxs)("p",{className:"mt-2",children:[r.jsx("a",{href:"#",className:"hover:text-slate-700",children:"隐私政策"})," \xb7 ",r.jsx("a",{href:"#",className:"hover:text-slate-700",children:"服务条款"})," \xb7 ",r.jsx("a",{href:"#",className:"hover:text-slate-700",children:"开源代码"})]})]})]})})}function w({icon:e,title:t,description:s}){return(0,r.jsxs)("div",{className:"bg-white rounded-xl p-6 shadow-md hover:shadow-lg transition-shadow",children:[r.jsx("div",{className:"flex items-center gap-3 mb-3 text-blue-600",children:e}),r.jsx("h3",{className:"text-lg font-semibold text-slate-900 mb-2",children:t}),r.jsx("p",{className:"text-slate-600 text-sm",children:s})]})}},2029:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>l,metadata:()=>a,viewport:()=>i});var r=s(9510);s(5023);let a={title:"MemoVault - 隐私优先的个人知识库",description:"本地优先、端到端加密的个人知识管理系统",keywords:["知识库","笔记","隐私","加密","Local-First"],authors:[{name:"MemoVault Team"}],manifest:"/manifest.json",icons:{icon:"/favicon.ico",apple:"/apple-touch-icon.png"}},i={width:"device-width",initialScale:1,themeColor:"#3b82f6"};function l({children:e}){return(0,r.jsxs)("html",{lang:"zh-CN",children:[r.jsx("head",{children:r.jsx("meta",{name:"viewport",content:"width=device-width, initial-scale=1"})}),r.jsx("body",{className:"antialiased",children:e})]})}},5480:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});let r=(0,s(8570).createProxy)(String.raw`C:\Users\admin\Desktop\bianqian\src\app\page.tsx#default`)},5023:()=>{}};var t=require("../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[276,471,481],()=>s(4406));module.exports=r})();